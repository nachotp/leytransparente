{% extends 'base.html' %}
{% load static %}
{% block head_end %}
  <link rel="stylesheet" href="{% static 'lib/DataTables/dataTables.bootstrap4.min.css' %}">
  <script type="text/javascript" charset="utf8" src="{% static 'lib/DataTables/jquery-3.3.1.min.js' %}"></script>
  <script type="text/javascript" charset="utf8" src="{% static 'lib/DataTables/jquery.dataTables.min.js' %}"></script>
  <script type="text/javascript" charset="utf8" src="{% static 'lib/DataTables/dataTables.bootstrap4.min.js' %}"></script>
{% endblock %}

{% block content %}

<table  class="table table-striped table-bordered compact" id="dip_table" cellspacing="0">
	<thead>
		<tr>
			<td>Nombre</td>
			<td>Apellido Paterno</td>
			<td>Apellidos Materno</td>
            <td>
				<a class="btn btn-primary" href="{% url 'Subir declaracion' %}">Subir Declaracion</a>
			</td>
		</tr>
		
	</thead>
	<tbody>
		{% if diputados %}
		{% for diputado in diputados %}
		<tr>
			<td>{{ diputado.nombres }}</td>
			<td>{{ diputado.apellido_paterno }}</td>
			<td>{{ diputado.apellido_materno }}</td>
			<td>
				<a class="btn btn-sm btn-primary" href="#">Ver Declaracion</a>
                <a class="btn btn-sm btn-danger" href="#">Eliminar</a>
			</td>
		</tr>
		{% endfor %}
		
		{% else %}
		<h1>No hay registros de Parlamentarios</h1>
		{% endif %}
	</tbody>
</table>
{% endblock%}

{% block body_end %}
<script>
var table = "#dip_table";
console.log('creating table '+table);
$(table+' thead tr:eq(0) th').each( function (i) {
      var title = $(this).text();
      $(this).html( '<input type="text" class="form-control" style="width: 100%;" placeholder="filter '+title+'" />' );

      $( 'input', this ).on( 'keyup change', function () {
          if ( diputable.column(i).search() !== this.value ) {
              diputable
                  .column(i)
                  .search( this.value )
                  .draw();
          }
      });
  });

var diputable = $(table).DataTable({
  orderCellsTop: true,
  "order": [[ 0, "desc" ]],
  "scrollY":        "70vh",
  "scrollCollapse": true,
  "paging":         false,

});

diputable.columns( '.hidden-search' ).every( function () {
    var that = this;
    // Create the select list and search operation
    var select = $(table+'-select')
        .on( 'change', function () {
            that
                .search( $(this).val() )
                .draw();
        });
    that.search(select.val()).draw();
});
</script>
{% endblock %}